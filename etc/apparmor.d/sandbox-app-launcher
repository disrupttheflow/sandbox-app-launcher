## Copyright (C) 2012 - 2020 ENCRYPTED SUPPORT LP <adrelanos@riseup.net>
## See the file COPYING for copying conditions.

#include <tunables/global>

@{AUTO_DIR}=/var/cache/sandbox-app-launcher-autogenerated
@{WRAPPER_DIR}=@{AUTO_DIR}/wrappers
@{WRAPPER_DIR_WX}=@{AUTO_DIR}/wrappers-wx
@{HOME_DIR}=/home/sandbox-app-launcher-appdata
@{SHARED_DIR}=@{HOME_DIR}/shared /shared

profile sandbox-app-launcher @{WRAPPER_DIR}/** flags=(attach_disconnected) {
  #include <abstractions/sandbox-app-launcher>

  ## Deny W^X violations.
  deny @{HOME_DIR}/*/** xm,
  deny @{SHARED_DIR}/** xm,
  deny /{,var/}tmp/** xm,
  deny /dev/shm/** m,
  deny /sys/fs/cgroup/** m,
}

profile sandbox-app-launcher-wx @{WRAPPER_DIR_WX}/** flags=(attach_disconnected) {
  #include <abstractions/sandbox-app-launcher>

  ## Allow W^X violations.
  owner @{HOME_DIR}/*/** rwmlkix,
  @{SHARED_DIR}/** rwmlkix,
  owner /{,var/}tmp/** rwmlkix,
  owner /dev/shm/** rwm,
  /sys/fs/cgroup/** rwm,
}
